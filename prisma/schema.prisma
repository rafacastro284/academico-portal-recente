generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model alunodisciplina {
  idalunodisciplina Int          @id @default(autoincrement())
  idaluno           Int
  iddisciplina      Int
  usuario           usuario      @relation(fields: [idaluno], references: [idusuario], onDelete: NoAction, onUpdate: NoAction)
  disciplina        disciplina   @relation(fields: [iddisciplina], references: [iddisciplina], onDelete: NoAction, onUpdate: NoAction)
  frequencia        frequencia[]
  nota              nota[]
}

model disciplina {
  iddisciplina    Int               @id @default(autoincrement())
  idprofessor     Int
  nome_disciplina String?           @db.VarChar(100)
  carga_horaria   Int?
  alunodisciplina alunodisciplina[]
  usuario         usuario           @relation(fields: [idprofessor], references: [idusuario], onDelete: NoAction, onUpdate: NoAction)
  tarefa          tarefa[]
}

model frequencia {
  idfrequencia      Int             @id @default(autoincrement())
  idalunodisciplina Int
  data              DateTime?       @db.Date
  faltas            Int?            @default(0)
  alunodisciplina   alunodisciplina @relation(fields: [idalunodisciplina], references: [idalunodisciplina], onDelete: NoAction, onUpdate: NoAction)
}

model matriculaturma {
  idmatriculaturma Int     @id @default(autoincrement())
  idusuario        Int
  idturma          Int
  turma            turma   @relation(fields: [idturma], references: [idturma], onDelete: NoAction, onUpdate: NoAction)
  usuario          usuario @relation(fields: [idusuario], references: [idusuario], onDelete: NoAction, onUpdate: NoAction)
}

model nota {
  idnota            Int             @id @default(autoincrement())
  idalunodisciplina Int
  descricao         String?         @db.VarChar(200)
  valor             Decimal?        @db.Decimal(5, 2)
  data              DateTime?       @db.Date
  alunodisciplina   alunodisciplina @relation(fields: [idalunodisciplina], references: [idalunodisciplina], onDelete: NoAction, onUpdate: NoAction)
}

model tarefa {
  idtarefa     Int        @id @default(autoincrement())
  iddisciplina Int
  tipo         String?    @db.VarChar(50)
  descricao    String?
  disciplina   disciplina @relation(fields: [iddisciplina], references: [iddisciplina], onDelete: NoAction, onUpdate: NoAction)
}

model turma {
  idturma        Int              @id @default(autoincrement())
  nome_turma     String?          @db.VarChar(50)
  ano_letivo     Int?
  limite_vagas   Int?
  matriculaturma matriculaturma[]
}

model usuario {
  idusuario       Int               @id @default(autoincrement())
  cpf             String?           @unique @db.VarChar(14)
  matricula       String?           @db.VarChar(20)
  nome            String?           @db.VarChar(100)
  email           String?           @unique @db.VarChar(100)
  senha           String?           @db.VarChar(255)
  tipo            tipo_usuario
  alunodisciplina alunodisciplina[]
  disciplina      disciplina[]
  matriculaturma  matriculaturma[]
}


enum tipo_usuario {
  aluno
  professor
  secretario
  admin
  diretor
}
